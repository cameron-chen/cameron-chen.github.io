<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>AHK 第二辑：除了必须的，还有附赠的 | Think Different</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://cameron-chen.github.io/favicon.ico?v=1589720811924">
<link rel="stylesheet" href="https://cameron-chen.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="在阅读本文之前，建议先阅读 AHK 第一辑：Win 上的效率工具

这篇文章其实和我预想出来的样子不太一样，原本希望是像彩蛋一样，给大家介绍一些不常用到但是很好玩的内容。但在收集素材的过程中，我发现这个工具有他自己的属性，有其擅长的地方。它..." />
    <meta name="keywords" content="ahk,效率" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://cameron-chen.github.io">
        <img src="https://cameron-chen.github.io/images/avatar.png?v=1589720811924" class="site-logo">
        <h1 class="site-title">Think Different</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      The only thing you can't do is ignore them
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://cameron-chen.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">AHK 第二辑：除了必须的，还有附赠的</h2>
            <div class="post-date">2019-04-14</div>
            
              <div class="feature-container" style="background-image: url('https://owncloud-c.oss-cn-shanghai.aliyuncs.com/img/灯.jpg')">
              </div>
            
            <div class="post-content" v-pre>
              <p>在阅读本文之前，建议先阅读 <a href="https://cameron-chen.github.io/post/ahk_1/">AHK 第一辑：Win 上的效率工具</a></p>
<!-- more -->
<p>这篇文章其实和我预想出来的样子不太一样，原本希望是像彩蛋一样，给大家介绍一些不常用到但是很好玩的内容。但在收集素材的过程中，我发现这个工具有他自己的属性，有其擅长的地方。它强在：</p>
<blockquote>
<p>对键盘鼠标信号的友好映射，对许多函数的封装并易于调取。所以说在：1. 按键和热字串的映射；2. 辅助增强型的小工具。这两个应用方向上能够提供良好体验</p>
</blockquote>
<p>诚然如上一篇文章介绍，它本质上是一个编程软件和编程语言，它能够完成很多程序也能完成的事情，但<strong>术业有专攻</strong>，一个应用只有在做它最擅长的事时，才能带给人独特和舒服的体验。</p>
<p>所以，这篇文章变成了你接下来看到的样子。</p>
<h2 id="实现环境">实现环境</h2>
<ul>
<li>软件：<a href="https://github.com/Lexikos/AutoHotkey_L/releases">AutoHotKey_L</a>，直接下载最新版本的<code>exe</code>文件</li>
<li>操作系统：Win10</li>
<li>技术基础：windows 基本操作，能通过搜索引擎排除简单错误</li>
<li>帮助文档：<a href="http://ahkcn.sourceforge.net/docs/AutoHotkey.htm">AutoHotKey Docs</a></li>
</ul>
<h2 id="作为效率工具的增强">作为效率工具的增强</h2>
<p>上一辑讲到，<code>AHK</code>被创造的目的是希望延申 PC 系统中快捷键（shortcut）这个功能，它支持更加灵活的自定义和更加复杂的流程。</p>
<p><strong>效率提升</strong>是对我这个软件功能的定义。这一节在上一章的基础上，提供更多的示例，让你的电脑用起来更顺心。</p>
<h3 id="一键拷贝文章路径">一键拷贝文章路径</h3>
<p>这项功能的应用场景在于上传文件需要输入路径，查找快捷方式的原文件地址等需要查找文件路径的操作，将右键  --&gt; 属性  --&gt; 复制路径  --&gt; 添加文件名这个流程简化为<code>Ctrl+shift+c</code>的按键组合。</p>
<p>代码如下：</p>
<pre><code class="language-language">^+c::
send ^c
sleep,200
clipboard=%clipboard% ;%null%
tooltip,%clipboard%
sleep,500
tooltip,
return
</code></pre>
<h3 id="热键放大缩小窗口">热键放大缩小窗口</h3>
<p>这项功能的应用场景在于不再把鼠标移到右上角去点击窗口的缩放键。这是我很喜欢的一个功能，它的意义不仅仅在于不用再移动鼠标操作，而是忙你避免了<strong>寻找缩放键和移动鼠标</strong>这两个动作，实现“盲操”，无论你的缩放键跑到哪去，<code>Alt + m</code>这两个键一直就在那。</p>
<p>代码如下：</p>
<pre><code class="language-language">!m:: 
if WinStatus=0 
  { 
  WinMaximize , A 
  WinStatus:=1 
  } 
else 
  { 
  WinRestore ,A 
  WinStatus:=0 
  } 
return
</code></pre>
<h3 id="浏览器操作">浏览器操作</h3>
<p>只有在浏览器界面会执行的热键操作。具体解释见代码块注释。</p>
<p>代码如下：</p>
<pre><code class="language-language">#IfWinActive ahk_class Chrome_WidgetWin_0   ;确定浏览器窗口开启 
!,::Send ^+{Tab}       ;上一页面
!.::Send ^{Tab}        ;下一页面
!1::Send ^+{Tab}       ;上一页面
!2::Send ^{Tab}        ;下一页面
!n::Send ^t            ;开启新页面
!/::Send ^w            ;关闭当前页面
!z::Send ^+t           ;恢复上一关闭页面
!-::Send ^-            ;网页缩小
!=::Send ^=            ;网页放大
</code></pre>
<p>确定浏览器窗口开启的语句中需要用到浏览器的特征代码，如上例中：<code>ahk_class Chrome_WidgetWin_0</code>。此代码可直接由软件自带的<code>Windows Spy</code>获取。</p>
<p>Windows Spy ▼<br>
<img src="https://owncloud-c.oss-cn-shanghai.aliyuncs.com/img/20190414151738.jpg#shadow=true&amp;mirages-width=891&amp;mirages-height=698&amp;mirages-cdn-type=4" alt="Windows Spy" loading="lazy"></p>
<h2 id="两个小工具">两个小工具</h2>
<p>在使用 AHK 过程中，发现两个小众玩法，分享。</p>
<h3 id="秒杀多次点击">秒杀，多次点击</h3>
<p>电商为了导流喜欢举办一些秒杀活动，让顾客来拼手速。</p>
<p>在你狂点鼠标的时候，AHK 用这个方法给你加成。</p>
<p>原理是设置快捷键，AHK 模拟鼠标左击操作，通过程序重复点击 x 次。具体次数可以自行设置。</p>
<p>代码如下：</p>
<pre><code class="language-language">Capslock &amp; 1::      ;按键 Capslock + 1 触发，发送鼠标左击 50 次，可自定义
click 50
return
</code></pre>
<p>本来想做个截图看看，但是 ... 要怎么在点击第一下的时候开始记时？发现网上也没有满足条件的测试应用，你可以自己测试。</p>
<h3 id="拾色器">拾色器</h3>
<p>想获取图片中某一点的颜色，又不想打开 PS 或者其他软件。可以给一直在后台挂着的 AHK 增加一个小功能：将鼠标选取点那一个像素的颜色发送到剪贴板，之后再用<code>Ctrl + c</code>就能看到颜色的代码。</p>
<p>代码如下：</p>
<pre><code class="language-language">^#c::
MouseGetPos, mouseX, mouseY
; 获得鼠标所在坐标，把鼠标的 X 坐标赋值给变量 mouseX ，同理 mouseY
PixelGetColor, color, %mouseX%, %mouseY%, RGB
; 调用 PixelGetColor 函数，获得鼠标所在坐标的 RGB 值，并赋值给 color
StringRight color,color,6
; 截取 color（第二个 color）右边的6个字符，因为获得的值是这样的：#RRGGBB，一般我们只需要 RRGGBB 部分。把截取到的值再赋给 color（第一个 color）。
clipboard = %color%
; 把 color 的值发送到剪贴板
return
</code></pre>
<h2 id="参考">参考</h2>
<p>本文参考了如下文章</p>
<ul>
<li>Win下最爱效率神器：AutoHotKey：<a href="https://www.jeffjade.com/2016/03/11/2016-03-11-autohotkey/">倾城之链</a></li>
<li>知乎某用户：由于实在没找到最初参考的作者，在此道歉</li>
</ul>
<p>感谢 🎈</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://cameron-chen.github.io/tag/kkx6ywczH/" class="tag">
                    ahk
                  </a>
                
                  <a href="https://cameron-chen.github.io/tag/m5f1GxPc3K/" class="tag">
                    效率
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://cameron-chen.github.io/post/ahk_1/">
                  <h3 class="post-title">
                    AHK 第一辑：Win 上的效率工具
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>





  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: 'b0b5994afc452f1e89d9',
        clientSecret: '21b4959726f9da0d7826e5151618e8cc08fe440d',
        repo: 'cameron-chen.github.io',
        owner: 'cameron-chen',
        admin: ['cameron-chen'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
